{"remainingRequest":"E:\\01_PERCEPTRON\\Deployment\\PerceptronFrontEnd\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js??ref--3-1!E:\\01_PERCEPTRON\\Deployment\\PerceptronFrontEnd\\node_modules\\ngx-embed-video\\dist\\src\\embed-video.service.js","dependencies":[{"path":"E:\\01_PERCEPTRON\\Deployment\\PerceptronFrontEnd\\node_modules\\ngx-embed-video\\dist\\src\\embed-video.service.js","mtime":1520362184000},{"path":"E:\\01_PERCEPTRON\\Deployment\\PerceptronFrontEnd\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1532940271448},{"path":"E:\\01_PERCEPTRON\\Deployment\\PerceptronFrontEnd\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js","mtime":1532940256149}],"contextDependencies":[],"result":["\"use strict\";\nvar __decorate = /*@__PURE__*/ require(\"tslib\").__decorate;\nvar __metadata = /*@__PURE__*/ require(\"tslib\").__metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar core_1 = require(\"@angular/core\");\nvar http_1 = require(\"@angular/http\");\nvar platform_browser_1 = require(\"@angular/platform-browser\");\nrequire(\"rxjs/add/operator/toPromise\");\nrequire(\"rxjs/add/operator/map\");\nvar EmbedVideoService = /*@__PURE__*/ (function () {\n    function EmbedVideoService(http, sanitizer) {\n        this.http = http;\n        this.sanitizer = sanitizer;\n        this.validYouTubeOptions = [\n            'default',\n            'mqdefault',\n            'hqdefault',\n            'sddefault',\n            'maxresdefault'\n        ];\n        this.validVimeoOptions = [\n            'thumbnail_small',\n            'thumbnail_medium',\n            'thumbnail_large'\n        ];\n        this.validDailyMotionOptions = [\n            'thumbnail_60_url',\n            'thumbnail_120_url',\n            'thumbnail_180_url',\n            'thumbnail_240_url',\n            'thumbnail_360_url',\n            'thumbnail_480_url',\n            'thumbnail_720_url',\n            'thumbnail_1080_url'\n        ];\n    }\n    EmbedVideoService.prototype.embed = function (url, options) {\n        var id;\n        url = new URL(url);\n        id = this.detectYoutube(url);\n        if (id) {\n            return this.embed_youtube(id, options);\n        }\n        id = this.detectVimeo(url);\n        if (id) {\n            return this.embed_vimeo(id, options);\n        }\n        id = this.detectDailymotion(url);\n        if (id) {\n            return this.embed_dailymotion(id, options);\n        }\n    };\n    EmbedVideoService.prototype.embed_youtube = function (id, options) {\n        options = this.parseOptions(options);\n        var queryString;\n        if (options && options.hasOwnProperty('query')) {\n            queryString = '?' + this.serializeQuery(options.query);\n        }\n        return this.sanitize_iframe('<iframe src=\"https://www.youtube.com/embed/'\n            + id + options.query + '\"' + options.attr\n            + ' frameborder=\"0\" allowfullscreen></iframe>');\n    };\n    EmbedVideoService.prototype.embed_vimeo = function (id, options) {\n        options = this.parseOptions(options);\n        var queryString;\n        if (options && options.hasOwnProperty('query')) {\n            queryString = '?' + this.serializeQuery(options.query);\n        }\n        return this.sanitize_iframe('<iframe src=\"https://player.vimeo.com/video/'\n            + id + options.query + '\"' + options.attr\n            + ' frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>');\n    };\n    EmbedVideoService.prototype.embed_dailymotion = function (id, options) {\n        options = this.parseOptions(options);\n        var queryString;\n        if (options && options.hasOwnProperty('query')) {\n            queryString = '?' + this.serializeQuery(options.query);\n        }\n        return this.sanitize_iframe('<iframe src=\"https://www.dailymotion.com/embed/video/'\n            + id + options.query + '\"' + options.attr\n            + ' frameborder=\"0\" allowfullscreen></iframe>');\n    };\n    EmbedVideoService.prototype.embed_image = function (url, options) {\n        var id;\n        url = new URL(url);\n        id = this.detectYoutube(url);\n        if (id) {\n            return this.embed_youtube_image(id, options);\n        }\n        id = this.detectVimeo(url);\n        if (id) {\n            return this.embed_vimeo_image(id, options);\n        }\n        id = this.detectDailymotion(url);\n        if (id) {\n            return this.embed_dailymotion_image(id, options);\n        }\n    };\n    EmbedVideoService.prototype.embed_youtube_image = function (id, options) {\n        if (typeof options === 'function') {\n            options = {};\n        }\n        options = options || {};\n        options.image = this.validYouTubeOptions.indexOf(options.image) > 0 ? options.image : 'default';\n        var src = 'https://img.youtube.com/vi/' + id + '/' + options.image + '.jpg';\n        var result = {\n            link: src,\n            html: '<img src=\"' + src + '\"/>'\n        };\n        return new Promise(function (resolve, reject) {\n            resolve(result);\n        });\n    };\n    EmbedVideoService.prototype.embed_vimeo_image = function (id, options) {\n        if (typeof options === 'function') {\n            options = {};\n        }\n        options = options || {};\n        options.image = this.validVimeoOptions.indexOf(options.image) >= 0 ? options.image : 'thumbnail_large';\n        return this.http.get('https://vimeo.com/api/v2/video/' + id + '.json')\n            .map(function (res) {\n            return {\n                'link': res.json()[0][options.image],\n                'html': '<img src=\"' + res.json()[0][options.image] + '\"/>'\n            };\n        })\n            .toPromise()\n            .catch(function (error) { return console.log(error); });\n    };\n    EmbedVideoService.prototype.embed_dailymotion_image = function (id, options) {\n        if (typeof options === 'function') {\n            options = {};\n        }\n        options = options || {};\n        options.image = this.validDailyMotionOptions.indexOf(options.image) >= 0 ? options.image : 'thumbnail_480_url';\n        return this.http.get('https://api.dailymotion.com/video/' + id + '?fields=' + options.image)\n            .map(function (res) {\n            return {\n                'link': res.json()[options.image],\n                'html': '<img src=\"' + res.json()[options.image] + '\"/>'\n            };\n        })\n            .toPromise()\n            .catch(function (error) { return console.log(error); });\n    };\n    EmbedVideoService.prototype.parseOptions = function (options) {\n        var queryString = '', attributes = '';\n        if (options && options.hasOwnProperty('query')) {\n            queryString = '?' + this.serializeQuery(options.query);\n        }\n        if (options && options.hasOwnProperty('attr')) {\n            var temp_1 = [];\n            Object.keys(options.attr).forEach(function (key) {\n                temp_1.push(key + '=\"' + (options.attr[key]) + '\"');\n            });\n            attributes = ' ' + temp_1.join(' ');\n        }\n        return {\n            query: queryString,\n            attr: attributes\n        };\n    };\n    EmbedVideoService.prototype.serializeQuery = function (query) {\n        var queryString = [];\n        for (var p in query) {\n            if (query.hasOwnProperty(p)) {\n                queryString.push(encodeURIComponent(p) + '=' + encodeURIComponent(query[p]));\n            }\n        }\n        return queryString.join('&');\n    };\n    EmbedVideoService.prototype.sanitize_iframe = function (iframe) {\n        return this.sanitizer.bypassSecurityTrustHtml(iframe);\n    };\n    EmbedVideoService.prototype.detectVimeo = function (url) {\n        return (url.hostname === 'vimeo.com') ? url.pathname.split('/')[1] : null;\n    };\n    EmbedVideoService.prototype.detectYoutube = function (url) {\n        if (url.hostname.indexOf('youtube.com') > -1) {\n            return url.search.split('=')[1];\n        }\n        if (url.hostname === 'youtu.be') {\n            return url.pathname.split('/')[1];\n        }\n        return '';\n    };\n    EmbedVideoService.prototype.detectDailymotion = function (url) {\n        if (url.hostname.indexOf('dailymotion.com') > -1) {\n            return url.pathname.split('/')[2].split('_')[0];\n        }\n        if (url.hostname === 'dai.ly') {\n            return url.pathname.split('/')[1];\n        }\n        return '';\n    };\n    EmbedVideoService = __decorate([\n        core_1.Injectable()\n    ], EmbedVideoService);\n    return EmbedVideoService;\n}());\nexports.EmbedVideoService = EmbedVideoService;\n",null]}